
 # City of Portland Assessment Connect
 ## City of Portland Property Data 
 Dataset Link: portlandme.data.socrata.com/d/kx7n-ab4t 
 Parent Queries for dataset are: 

 | Parent Queries |
|--------- |
 | select *,avg(sale_ratio) over (partition by land_use_type) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median |
 #### Data Dimensions

 | Name | Field Name |
|--------- |--------- |
 | Class | class_desc |
 | Land Use Type | luc_desc |
 | Style | style_desc |
 | Grade | grade_desc |
 | Stories | stories |
 #### Measures

 | Measure Name | SoQL Query | Example Link | Approximate Query Time (in seconds) |
|--------- |--------- |--------- |--------- |
 | Estimated Total Market Value | `select *,avg(sale_ratio) over (partition by land_use_type) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median   \|>   SELECT SUM(appr_total)` | [https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select *,avg\(sale_ratio\) over \(partition by land_use_type\) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median \|> SELECT SUM\(appr_total\)](https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select%20%2A%2Cavg%28sale_ratio%29%20over%20%28partition%20by%20land_use_type%29%20as%20median_sale_ratio%2C%201-sale_ratio/median_sale_ratio%20as%20sale_ratio_deviation_from_median%20%7C%3E%20SELECT%20SUM%28appr_total%29) | 1.18 |
 | Average Sales Ratio | `select *,avg(sale_ratio) over (partition by land_use_type) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median   \|>   SELECT AVG(appr_total/case(sale_price <= 0 or sale_price is null, case(appr_total == 0, 1, true, appr_total) , true, sale_price))` | [https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select *,avg\(sale_ratio\) over \(partition by land_use_type\) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median \|> SELECT AVG\(appr_total/case\(sale_price <= 0 or sale_price is null, case\(appr_total == 0, 1, true, appr_total\) , true, sale_price\)\)](https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select%20%2A%2Cavg%28sale_ratio%29%20over%20%28partition%20by%20land_use_type%29%20as%20median_sale_ratio%2C%201-sale_ratio/median_sale_ratio%20as%20sale_ratio_deviation_from_median%20%7C%3E%20SELECT%20AVG%28appr_total/case%28sale_price%20%3C%3D%200%20or%20sale_price%20is%20null%2C%20case%28appr_total%20%3D%3D%200%2C%201%2C%20true%2C%20appr_total%29%20%2C%20true%2C%20sale_price%29%29) | 1.03 |
 | Total Sales | `select *,avg(sale_ratio) over (partition by land_use_type) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median   \|>   SELECT COUNT(saledt)` | [https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select *,avg\(sale_ratio\) over \(partition by land_use_type\) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median \|> SELECT COUNT\(saledt\)](https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select%20%2A%2Cavg%28sale_ratio%29%20over%20%28partition%20by%20land_use_type%29%20as%20median_sale_ratio%2C%201-sale_ratio/median_sale_ratio%20as%20sale_ratio_deviation_from_median%20%7C%3E%20SELECT%20COUNT%28saledt%29) | 1.33 |
 | Coefficient of Dispersion | `select *,avg(sale_ratio) over (partition by land_use_type) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median   \|>   SELECT (avg(sale_ratio_deviation_from_median)/avg(median_sale_ratio))` | [https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select *,avg\(sale_ratio\) over \(partition by land_use_type\) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median \|> SELECT \(avg\(sale_ratio_deviation_from_median\)/avg\(median_sale_ratio\)\)](https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select%20%2A%2Cavg%28sale_ratio%29%20over%20%28partition%20by%20land_use_type%29%20as%20median_sale_ratio%2C%201-sale_ratio/median_sale_ratio%20as%20sale_ratio_deviation_from_median%20%7C%3E%20SELECT%20%28avg%28sale_ratio_deviation_from_median%29/avg%28median_sale_ratio%29%29) | 1.0 |
 | Price Relative Differential | `select *,avg(sale_ratio) over (partition by land_use_type) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median   \|>   SELECT (avg(sale_ratio)/(   sum(sale_appr_value)/sum(sale_price)    ))` | [https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select *,avg\(sale_ratio\) over \(partition by land_use_type\) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median \|> SELECT \(avg\(sale_ratio\)/\(   sum\(sale_appr_value\)/sum\(sale_price\)    \)\)](https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select%20%2A%2Cavg%28sale_ratio%29%20over%20%28partition%20by%20land_use_type%29%20as%20median_sale_ratio%2C%201-sale_ratio/median_sale_ratio%20as%20sale_ratio_deviation_from_median%20%7C%3E%20SELECT%20%28avg%28sale_ratio%29/%28%20%20%20sum%28sale_appr_value%29/sum%28sale_price%29%20%20%20%20%29%29) | 1.14 |
 | Average Absolute Deviation | `select *,avg(sale_ratio) over (partition by land_use_type) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median   \|>   SELECT AVG(sale_ratio_deviation_from_median)` | [https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select *,avg\(sale_ratio\) over \(partition by land_use_type\) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median \|> SELECT AVG\(sale_ratio_deviation_from_median\)](https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select%20%2A%2Cavg%28sale_ratio%29%20over%20%28partition%20by%20land_use_type%29%20as%20median_sale_ratio%2C%201-sale_ratio/median_sale_ratio%20as%20sale_ratio_deviation_from_median%20%7C%3E%20SELECT%20AVG%28sale_ratio_deviation_from_median%29) | 1.31 |
 | Median Ratio | `select *,avg(sale_ratio) over (partition by land_use_type) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median   \|>   SELECT AVG(sale_appr_value/case(sale_price <= 0 or sale_price is null, case(sale_appr_value == 0, 1, true, sale_appr_value) , true, sale_price))` | [https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select *,avg\(sale_ratio\) over \(partition by land_use_type\) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median \|> SELECT AVG\(sale_appr_value/case\(sale_price <= 0 or sale_price is null, case\(sale_appr_value == 0, 1, true, sale_appr_value\) , true, sale_price\)\)](https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select%20%2A%2Cavg%28sale_ratio%29%20over%20%28partition%20by%20land_use_type%29%20as%20median_sale_ratio%2C%201-sale_ratio/median_sale_ratio%20as%20sale_ratio_deviation_from_median%20%7C%3E%20SELECT%20AVG%28sale_appr_value/case%28sale_price%20%3C%3D%200%20or%20sale_price%20is%20null%2C%20case%28sale_appr_value%20%3D%3D%200%2C%201%2C%20true%2C%20sale_appr_value%29%20%2C%20true%2C%20sale_price%29%29) | 1.05 |
 | % Parcels Sold | `select *,avg(sale_ratio) over (partition by land_use_type) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median   \|>   select *, :@computed_region_52nt_trix, case(saledt between {START_DATE} and {END_DATE} ,1,true,0) as has_sold   \|>   SELECT ((sum(has_sold)/count(*))::double*100)` | [https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select *,avg\(sale_ratio\) over \(partition by land_use_type\) as median_sale_ratio, 1-sale_ratio/median_sale_ratio as sale_ratio_deviation_from_median \|> select *, :@computed_region_52nt_trix, case\(saledt between '2017-2-18' and '2020-02-18' ,1,true,0\) as has_sold \|> SELECT \(\(sum\(has_sold\)/count\(*\)\)::double*100\)](https://portlandme.data.socrata.com/resource/kx7n-ab4t.json?$query=select%20%2A%2Cavg%28sale_ratio%29%20over%20%28partition%20by%20land_use_type%29%20as%20median_sale_ratio%2C%201-sale_ratio/median_sale_ratio%20as%20sale_ratio_deviation_from_median%20%7C%3E%20select%20%2A%2C%20%3A%40computed_region_52nt_trix%2C%20case%28saledt%20between%20%272017-2-18%27%20and%20%272020-02-18%27%20%2C1%2Ctrue%2C0%29%20as%20has_sold%20%7C%3E%20SELECT%20%28%28sum%28has_sold%29/count%28%2A%29%29%3A%3Adouble%2A100%29) | 1.29 |